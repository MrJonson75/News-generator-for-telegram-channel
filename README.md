# –ö–∞–∫ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## 1. –ú–µ—Ö–∞–Ω–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –ø–∞—Ä—Å–µ—Ä–∞ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

–°–∏—Å—Ç–µ–º–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –Ω–æ–≤–æ—Å—Ç–µ–π —É—Å—Ç—Ä–æ–µ–Ω–∞ –º–æ–¥—É–ª—å–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Celery-–∑–∞–¥–∞—á–∏. –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞—Ä—Å–µ—Ä `parse_and_save_news` –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç) –∏ —Å–æ–±–∏—Ä–∞–µ—Ç –Ω–æ–≤–æ—Å—Ç–∏ —Å —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤: Habr, RBC –∏ Telegram. –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö `Source`: –µ—Å–ª–∏ –≤ —Å—Ç–æ–ª–±—Ü–µ `enabled` —Å—Ç–æ–∏—Ç `True`, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø–∞—Ä—Å–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è; –µ—Å–ª–∏ `False` ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ, –µ—Å–ª–∏ –±–∞–∑–∞ –ø—É—Å—Ç–∞, –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ö–∞–∂–¥–∞—è —Å–æ–±—Ä–∞–Ω–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Pydantic (`ParsedNewsSchema`), —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –∏ –¥–µ–¥—É–ø–ª–∏—Ü–∏—Ä—É–µ—Ç—Å—è –ø–æ URL. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–æ–≤–æ—Å—Ç–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `NewsItem`, –∞ –Ω–æ–≤—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ ‚Äî –≤ `Source` —Å —Ñ–ª–∞–≥–æ–º `enabled=True`. –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏, –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –ø–∞—Ä—Å–∏–Ω–≥–∞.

```text
+------------------+        +------------------+
|     Celery       |        |    Scheduler     |
|  Task Worker     |<------>| (every 30 min)   |
+--------+---------+        +------------------+
|
v
+------------------+
|  news_collector  |
|  (dynamic tasks) |
+--------+---------+
|
v
+------------------+       +------------------+
| Parser Modules   |------>|  Source Enabled? |
| Habr / RBC / TG  |       |    DB Check      |
+--------+---------+       +------------------+
|
v
+------------------+
| Validate & Filter|
| (Pydantic & Keywords)|
+--------+---------+
|
v
+------------------+
| Deduplicate URLs |
+--------+---------+
|
v
+------------------+
|   Database       |
| NewsItem / Source|
+------------------+
```

* **Celery Worker** ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–¥–∞—á—É `parse_and_save_news`.
* **Scheduler** ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç –∑–∞–¥–∞—á—É –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é.
* **news_collector** ‚Äî —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–æ–º –ø–∞—Ä—Å–µ—Ä–æ–≤ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.
* **Parser Modules** ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (Habr, RBC, Telegram).
* **Validate & Filter** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –Ω–æ–≤–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ Pydantic, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º.
* **Deduplicate URLs** ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º.
* **Database** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏ –Ω–æ–≤–æ—Å—Ç–µ–π –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö `Source` –∏ `NewsItem`.

---

## 2. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–æ—Å—Ç–æ–≤ –¥–ª—è Telegram —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Celery

–î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ—Å—Ç–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–º–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á: `generate_posts`, `cleanup_old_failed_posts`, `generate_post_keywords`. –û–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –±–∞–∑–µ Celery, SQLAlchemy –∏ OpenAI GPT-4o-mini.

### 2.1 –ó–∞–¥–∞—á–∞ `generate_posts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–æ–≤–æ—Å—Ç–µ–π –¥–ª—è Telegram.

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

1. –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
2. –î–ª—è –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Å—Ç:

   * **published** ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ–º.
   * **failed** ‚Üí –µ—Å–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –ø–æ–ø—ã—Ç–æ–∫ (`MAX_RETRIES`), —É–¥–∞–ª—è–µ–º –ø–æ—Å—Ç –∏ –Ω–æ–≤–æ—Å—Ç—å.
   * **generated** ‚Üí –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–æ—Å—Ç.
3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ OpenAI GPT-4o-mini:

   * –û—à–∏–±–∫–∏ API —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç `retry_count` –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `error_message`.
   * –ü—É—Å—Ç–æ–π —Ç–µ–∫—Å—Ç —Ç–∞–∫–∂–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –æ—à–∏–±–∫–∞ (—Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø–æ–º–µ—Ç–∫–æ–π `failed` –ø–æ—Å–ª–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–∞ –ø–æ–ø—ã—Ç–æ–∫).
4. –£—Å–ø–µ—à–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è:

   * –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø–æ—Å—Ç —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `new` –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π.
5. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –∑–∞ –æ–¥–∏–Ω –∑–∞–ø—É—Å–∫ (`MAX_PER_RUN`).

**–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (Celery Beat):**
–ó–∞–¥–∞—á–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç.

---

### 2.2 –ó–∞–¥–∞—á–∞ `cleanup_old_failed_posts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ø–æ—Å—Ç–æ–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `failed` –∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ —á–∏—Å—Ç–æ—Ç–µ.

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

1. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –¥–∞—Ç–∞ –æ—Ç—Å–µ—á–µ–Ω–∏—è: —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞ –º–∏–Ω—É—Å `days` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 7).
2. –í—ã–±–∏—Ä–∞—é—Ç—Å—è –ø–æ—Å—Ç—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `failed` —Å—Ç–∞—Ä—à–µ —ç—Ç–æ–π –¥–∞—Ç—ã.
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞:

   * –£–¥–∞–ª—è–µ—Ç—Å—è —Å–≤—è–∑–∞–Ω–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å (–µ—Å–ª–∏ –µ—Å—Ç—å).
   * –£–¥–∞–ª—è–µ—Ç—Å—è —Å–∞–º –ø–æ—Å—Ç.
4. –ö–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

**–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (Celery Beat):**
–ó–∞–¥–∞—á–∞ –º–æ–∂–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑ –≤ –¥–µ–Ω—å).

---

### 2.3 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–≥–æ–≤ (–∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤) –¥–ª—è –ø–æ—Å—Ç–æ–≤

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ—Å—Ç–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∑–∞–¥–∞—á–∞ `generate_post_keywords`.

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

1. –ò–∑ –±–∞–∑—ã –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –ø–æ—Å—Ç—ã —Å–æ —Å—Ç–∞—Ç—É—Å–∞–º–∏ `new` –∏ `generated`.
2. –ü—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è –ø–æ—Å—Ç—ã –±–µ–∑ —Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ —É–∂–µ –∏–º–µ—é—â–∏–µ —Ç–µ–≥–∏.
3. –¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ OpenAI –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤.
4. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞:

   * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –≤ —Ç–∞–±–ª–∏—Ü–µ `Keyword`.
   * –°–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤—ã–π Keyword, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç.
   * –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å–≤—è–∑—å many-to-many —Å Post.
5. –í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–æ–º–º–∏—Ç—è—Ç—Å—è –≤ –±–∞–∑—É.

**–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (Celery Beat):**
–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 15‚Äì30 –º–∏–Ω—É—Ç –∏–ª–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –ø–æ—Å—Ç–æ–≤.

---

## 3. API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ—Å—Ç–∞–º–∏

### 3.1 –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤

**GET `/api/posts`** ‚Äî —Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π:

* `status` ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É (`new`, `generated`, `published`, `failed`)
* `page` ‚Äî –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
* `size` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

**–ü—Ä–∏–º–µ—Ä:**

```
GET /api/posts?status=new&page=1&size=10
```

**Swagger:** –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞.

---

### 3.2 –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –ø–æ—Å—Ç–∞

**GET `/api/posts/{post_id}`** ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–æ—Å—Ç –ø–æ ID.

**–ü—Ä–∏–º–µ—Ä:**

```
GET /api/posts/9250e8ec-9ebf-41bb-a5d7-9287a5380024
```

---

### 3.3 –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ—Å—Ç–∞

**PATCH `/api/posts/{post_id}/status`** ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ—Å—Ç–∞ (`new`, `generated`, `published`, `failed`).

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "status": "published"
}
```

---

### 3.4 –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞

**DELETE `/api/posts/{post_id}`** ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞ –ø–æ ID.

**–ü—Ä–∏–º–µ—Ä:**

```
DELETE /api/posts/9250e8ec-9ebf-41bb-a5d7-9287a5380024
```

---

### 3.5 –†—É—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤

**POST `/api/generate`** ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø–æ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ Celery –≤—Ä—É—á–Ω—É—é.

---

### 3.6 –ü—É–±–ª–∏–∫–∞—Ü–∏—è –ø–æ—Å—Ç–∞ –≤ Telegram

**POST `/api/posts/{post_id}/publish`** ‚Äî –ø—É–±–ª–∏–∫–∞—Ü–∏—è –ø–æ—Å—Ç–∞. –ú–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ `published`.
–î–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Å—Ç–∞—Ç—É—Å–µ `generated`.

---

## 4. Health-check

### 4.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞

**GET `/health`** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ OpenAI.

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**

```json
{
  "status": "ok",
  "database": "‚úÖ Database connection OK: 1",
  "openai": "ok"
}
```

---

### 4.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ Celery –∏ Redis

**GET `/health/celery`** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è Celery, Celery Beat –∏ –æ—á–µ—Ä–µ–¥–µ–π Redis:

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**

* `status` ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–æ—Ä–∫–µ—Ä–æ–≤
* `workers` ‚Äî —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤
* `active_tasks` ‚Äî —Ç–µ–∫—É—â–∏–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏
* `scheduled_tasks` ‚Äî –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ (—Ç–∞–π–º–µ—Ä—ã)
* `reserved_tasks` ‚Äî –∑–∞–¥–∞—á–∏ –≤ –æ—á–µ—Ä–µ–¥–∏

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**

```json
{
  "status": "ok",
  "workers": ["worker1@host"],
  "active_tasks": {"worker1@host": []},
  "scheduled_tasks": {"worker1@host": []},
  "reserved_tasks": {"worker1@host": []}
}
```

---

### 5. –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

* **Python 3.11+**
* **FastAPI** ‚Äî –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è API
* **SQLAlchemy** ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
* **Celery** ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
* **Redis** ‚Äî –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è Celery
* **OpenAI GPT-4o-mini** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ –∏ —Ç–µ–≥–æ–≤
* **Celery Beat** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
* **Pydantic** ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
* **Swagger / OpenAPI** ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏

---
```ansi
[1;34m                     +---------------------------+[0m
[1;34m                     |        –ö–ª–∏–µ–Ω—Ç / UI        |[0m
[1;34m                     +-----------+---------------+[0m
[0m                                 |
[1;33m             ------------------------------------------------[0m
[1;33m             |                      |                     |[0m
[1;32m      GET /api/posts           GET /api/posts/{id}   GET /health[0m
[1;32m  (—Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤, —Ñ–∏–ª—å—Ç—Ä       (–ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å—Ç–∞     (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–∞,[0m
[1;32m   –ø–æ —Å—Ç–∞—Ç—É—Å—É, –ø–∞–≥–∏–Ω–∞—Ü–∏—è)       –ø–æ ID)               –ë–î, OpenAI, Celery)[0m
[0m             |                      |                     |
[1;35m      +----------------+     +----------------+   +----------------+[0m
[1;35m      |  Post (DB)     |     |  Post (DB)     |   | Health Module  |[0m
[1;35m      |  NewsItem (DB) |     |  NewsItem (DB) |   | DB / OpenAI /  |[0m
[1;35m      |  Keyword (DB)  |     |  Keyword (DB)  |   | Celery / Redis |[0m
[1;35m      +--------+-------+     +--------+-------+   +----------------+[0m
[0m               |
[1;33m   --------------------------------------------[0m
[1;33m   |                   |                     |[0m
[1;32mPATCH /status     DELETE /api/posts/{id}   POST /generate[0m
[1;32m(—Å–º–µ–Ω–∞ —Å—Ç–∞—Ç—É—Å–∞)     (—É–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞)       (—Ä—É—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è)[0m
[0m   |                   |                     |
[1;35m   v                   v                     v[0m
[1;36m+----------------+  +----------------+  +----------------+[0m
[1;36m| Post (DB)      |  | Post (DB)      |  | Celery Task:   |[0m
[1;36m| —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª—ë–Ω|  | –∑–∞–ø–∏—Å—å —É–¥–∞–ª–µ–Ω–∞ |  | generate_posts |[0m
[1;36m+----------------+  +----------------+  +----------------+[0m
[0m                                       |
[1;36m                                       v[0m
[1;36m                                 +----------------+[0m
[1;36m                                 | Post (DB)      |[0m
[1;36m                                 | —Å—Ç–∞—Ç—É—Å = new   |[0m
[1;36m                                 +----------------+[0m
[0m                                       |
[1;32m                                       v[0m
[1;32m                             POST /api/posts/{id}/publish[0m
[1;32m                             (–ø—É–±–ª–∏–∫–∞—Ü–∏—è –ø–æ—Å—Ç–∞ –≤ Telegram)[0m
[0m                                       |
[1;36m                                       v[0m
[1;36m                                 +----------------+[0m
[1;36m                                 | Post (DB)      |[0m
[1;36m                                 | —Å—Ç–∞—Ç—É—Å =       |[0m
[1;36m                                 | published      |[0m
[1;36m                                 +----------------+[0m
[0m                                       |
[1;32m                                       v[0m
[1;32m                             POST /generate_post_keywords[0m
[1;32m                             (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–≥–æ–≤)[0m
[0m                                       |
[1;36m                                       v[0m
[1;36m                                 +----------------+[0m
[1;36m                                 | Keyword (DB)   |[0m
[1;36m                                 | —Å–≤—è–∑–∏ —Å –ø–æ—Å—Ç–∞–º–∏|[0m
[1;36m                                 +----------------+[0m

```
