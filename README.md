# –ö–∞–∫ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## 1. –ú–µ—Ö–∞–Ω–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –ø–∞—Ä—Å–µ—Ä–∞ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

–°–∏—Å—Ç–µ–º–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –Ω–æ–≤–æ—Å—Ç–µ–π —É—Å—Ç—Ä–æ–µ–Ω–∞ –º–æ–¥—É–ª—å–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Celery-–∑–∞–¥–∞—á–∏. –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞—Ä—Å–µ—Ä `parse_and_save_news` –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç) –∏ —Å–æ–±–∏—Ä–∞–µ—Ç –Ω–æ–≤–æ—Å—Ç–∏ —Å —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤: Habr, RBC –∏ Telegram. –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö `Source`: –µ—Å–ª–∏ –≤ —Å—Ç–æ–ª–±—Ü–µ `enabled` —Å—Ç–æ–∏—Ç `True`, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø–∞—Ä—Å–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è; –µ—Å–ª–∏ `False` ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ, –µ—Å–ª–∏ –±–∞–∑–∞ –ø—É—Å—Ç–∞, –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ö–∞–∂–¥–∞—è —Å–æ–±—Ä–∞–Ω–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Pydantic (`ParsedNewsSchema`), —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –∏ –¥–µ–¥—É–ø–ª–∏—Ü–∏—Ä—É–µ—Ç—Å—è –ø–æ URL. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–æ–≤–æ—Å—Ç–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `NewsItem`, –∞ –Ω–æ–≤—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ ‚Äî –≤ `Source` —Å —Ñ–ª–∞–≥–æ–º `enabled=True`. –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏, –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –ø–∞—Ä—Å–∏–Ω–≥–∞.

```

+------------------+        +------------------+
|     Celery       |        |    Scheduler     |
|  Task Worker     |<------>| (every 30 min)   |
+--------+---------+        +------------------+
|
v
+------------------+
|  news_collector  |
|  (dynamic tasks) |
+--------+---------+
|
v
+------------------+       +------------------+
| Parser Modules   |------>|  Source Enabled? |
| Habr / RBC / TG  |       |    DB Check      |
+--------+---------+       +------------------+
|
v
+------------------+
| Validate & Filter|
| (Pydantic & Keywords)|
+--------+---------+
|
v
+------------------+
| Deduplicate URLs |
+--------+---------+
|
v
+------------------+
|   Database       |
| NewsItem / Source|
+------------------+

```

* **Celery Worker** ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–¥–∞—á—É `parse_and_save_news`.  
* **Scheduler** ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç –∑–∞–¥–∞—á—É –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é.  
* **news_collector** ‚Äî —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–æ–º –ø–∞—Ä—Å–µ—Ä–æ–≤ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.  
* **Parser Modules** ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (Habr, RBC, Telegram).  
* **Validate & Filter** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –Ω–æ–≤–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ Pydantic, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º.  
* **Deduplicate URLs** ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º.  
* **Database** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏ –Ω–æ–≤–æ—Å—Ç–µ–π –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö `Source` –∏ `NewsItem`.  

---

## 2. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–æ—Å—Ç–æ–≤ –¥–ª—è Telegram —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Celery

–î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ—Å—Ç–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–º–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –¥–≤–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏: `generate_posts` –∏ `cleanup_old_failed_posts`. –û–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –±–∞–∑–µ Celery, SQLAlchemy –∏ OpenAI GPT-4o-mini.

### 2.1 –ó–∞–¥–∞—á–∞ `generate_posts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**  
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–æ–≤–æ—Å—Ç–µ–π –¥–ª—è Telegram.

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

1. –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
2. –î–ª—è –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Å—Ç:
   - **published** ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ–º.
   - **failed** ‚Üí –µ—Å–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –ø–æ–ø—ã—Ç–æ–∫ (`MAX_RETRIES`), —É–¥–∞–ª—è–µ–º –ø–æ—Å—Ç –∏ –Ω–æ–≤–æ—Å—Ç—å.
   - **generated** ‚Üí –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–æ—Å—Ç.
3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ OpenAI GPT-4o-mini:
   - –û—à–∏–±–∫–∏ API —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç `retry_count` –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `error_message`.
   - –ü—É—Å—Ç–æ–π —Ç–µ–∫—Å—Ç —Ç–∞–∫–∂–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –æ—à–∏–±–∫–∞ (—Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø–æ–º–µ—Ç–∫–æ–π `failed` –ø–æ—Å–ª–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–∞ –ø–æ–ø—ã—Ç–æ–∫).
4. –£—Å–ø–µ—à–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è:
   - –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø–æ—Å—Ç —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `new` –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π.
5. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –∑–∞ –æ–¥–∏–Ω –∑–∞–ø—É—Å–∫ (`MAX_PER_RUN`).

**–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (Celery Beat):**  
–ó–∞–¥–∞—á–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç.

---

### 2.2 –ó–∞–¥–∞—á–∞ `cleanup_old_failed_posts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**  
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ø–æ—Å—Ç–æ–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `failed` –∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ —á–∏—Å—Ç–æ—Ç–µ.

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

1. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –¥–∞—Ç–∞ –æ—Ç—Å–µ—á–µ–Ω–∏—è: —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞ –º–∏–Ω—É—Å `days` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 7).
2. –í—ã–±–∏—Ä–∞—é—Ç—Å—è –ø–æ—Å—Ç—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `failed` —Å—Ç–∞—Ä—à–µ —ç—Ç–æ–π –¥–∞—Ç—ã.
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞:
   - –£–¥–∞–ª—è–µ—Ç—Å—è —Å–≤—è–∑–∞–Ω–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å (–µ—Å–ª–∏ –µ—Å—Ç—å).
   - –£–¥–∞–ª—è–µ—Ç—Å—è —Å–∞–º –ø–æ—Å—Ç.
4. –ö–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –±–∞–∑—É.

**–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (Celery Beat):**  
–ó–∞–¥–∞—á–∞ –º–æ–∂–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑ –≤ –¥–µ–Ω—å).

---

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.11+**  
- **SQLAlchemy** ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö  
- **Celery** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏  
- **Redis** ‚Äî –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è Celery  
- **OpenAI GPT-4o-mini** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ –ø–æ—Å—Ç–æ–≤  
- **Celery Beat** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á  

---

### –ü—Ä–∏–º–µ—Ä –ª–æ–≥–æ–≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

```

üÜï –°–æ–∑–¥–∞–Ω –ø–æ—Å—Ç –¥–ª—è 131fa200-4d6e-4bc1-8eba-b33f53d01b67
‚ôªÔ∏è –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –ø–æ—Å—Ç –¥–ª—è dde889b4-ffb4-479c-a568-ba03be6a99d4
‚ö†Ô∏è –ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç OpenAI –¥–ª—è 345f000b-9a1a-438f-ad0b-8c245d1e05e2
‚ùå –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è 17d93fa4-0c57-40fd-8c85-a7fd169f9d79
üóë –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö failed –ø–æ—Å—Ç–æ–≤: 3 —É–¥–∞–ª–µ–Ω–æ
‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –ø–æ—Å—Ç–æ–≤: 4

```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–æ–≤–æ—Å—Ç–µ–π** –∏ **–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ —á–∏—Å—Ç–æ—Ç–µ**, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤.

---

### 2.3 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–≥–æ–≤ (–∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤) –¥–ª—è –ø–æ—Å—Ç–æ–≤

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ—Å—Ç–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ Celery ‚Äî `generate_post_keywords`.
–û–Ω–∞ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞ –ø–æ—Å—Ç–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–µ–≥–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

#### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

* –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–¥–µ–ª—è—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –ø–æ —Å–º—ã—Å–ª—É –ø–æ—Å—Ç–∞
* –§–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–µ–≥–æ–≤ –¥–ª—è:

  * —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
  * –ø–æ–∏—Å–∫–∞
  * –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
  * —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–¥–±–æ—Ä–æ–∫
* –ò—Å–∫–ª—é—á–∏—Ç—å —Ä—É—á–Ω–æ–µ —Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

#### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –ò–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –ø–æ—Å—Ç—ã —Å–æ —Å—Ç–∞—Ç—É—Å–∞–º–∏:

   * `new`
   * `generated`
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞:

   * –ï—Å–ª–∏ —Ç–µ–≥–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç ‚Üí –ø–æ—Å—Ç –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è
   * –ï—Å–ª–∏ —Ç–µ–∫—Å—Ç –ø—É—Å—Ç–æ–π ‚Üí –ø–æ—Å—Ç –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è
3. –¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ OpenAI –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
4. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞:

   * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –æ–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü–µ `Keyword`
   * –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å
   * –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å–≤—è–∑—å –º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º –º–µ–∂–¥—É `Post` –∏ `Keyword`
5. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–æ–º–º–∏—Ç—è—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

#### –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫ –∏ –ª–∏–º–∏—Ç–æ–≤ API

–í –∑–∞–¥–∞—á–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –º–µ—Ö–∞–Ω–∏–∑–º—ã —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏:

* –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö OpenAI (`MAX_RETRIES`)
* –ó–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ –¥–ª—è —Å–æ–±–ª—é–¥–µ–Ω–∏—è rate limit (`OPENAI_KEYWORD_DELAY`)
* –û–±—Ä–∞–±–æ—Ç–∫–∞ `IntegrityError` –ø—Ä–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ —Ç–µ–≥–æ–≤
* –ü—Ä–æ–ø—É—Å–∫ –ø–æ—Å—Ç–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö —Ç–µ–≥–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è

–¢–µ–≥–∏ –∏ —Å–≤—è–∑–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö:

```text
Post
 ‚îî‚îÄ‚îÄ< post_keywords >‚îÄ‚îÄ Keyword
```

* **Post** ‚Äî —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Å—Ç
* **Keyword** ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ
* **post_keywords** ‚Äî —Å–≤—è–∑—É—é—â–∞—è —Ç–∞–±–ª–∏—Ü–∞ many-to-many

#### –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (Celery Beat)

–ó–∞–¥–∞—á–∞ `generate_post_keywords` –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é, –Ω–∞–ø—Ä–∏–º–µ—Ä:

* –∫–∞–∂–¥—ã–µ 15‚Äì30 –º–∏–Ω—É—Ç
* –∏–ª–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –ø–æ—Å—Ç–æ–≤

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

* –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å OpenAI
* –≥–∏–±–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞–≥—Ä—É–∑–∫–æ–π
* –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ç–µ–≥–æ–≤ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ—Å—Ç–æ–≤

---

### –û–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è —Å—Ö–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

```text
+-------------------+
|  NewsItem (DB)    |
+---------+---------+
          |
          v
+-------------------+
| generate_posts    |
| (OpenAI text)     |
+---------+---------+
          |
          v
+-------------------+
|   Post (DB)       |
| status = new      |
+---------+---------+
          |
          v
+------------------------+
| generate_post_keywords |
| (OpenAI keywords)      |
+---------+--------------+
          |
          v
+-------------------+
| Keyword (DB)      |
+-------------------+
```

---

### –ü—Ä–∏–º–µ—Ä –ª–æ–≥–æ–≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–≥–æ–≤

```text
üè∑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã —Ç–µ–≥–∏ –¥–ª—è –ø–æ—Å—Ç–∞ 245c9a85-720e-438d-ba49-bdfaa986b149: ['python', 'ai', 'telegram', 'automation']
üü° –ü—Ä–æ–ø—É—â–µ–Ω –ø–æ—Å—Ç e04943aa-6d79-483d-9d11-385a4eca7d33, —Ç–µ–≥–∏ —É–∂–µ –µ—Å—Ç—å
‚ö†Ô∏è –ü–æ–ø—ã—Ç–∫–∞ 1/3 –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–≥–æ–≤ –Ω–µ —É–¥–∞–ª–∞—Å—å (429 Rate limit)
‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ —Ç–µ–≥–æ–≤ –¥–ª—è –ø–æ—Å—Ç–æ–≤: 6
```

---

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–∏—Å—Ç–µ–º–∞ –Ω–µ —Ç–æ–ª—å–∫–æ **–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç**, –Ω–æ –∏ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–µ—Ç –µ–≥–æ**, —Ñ–æ—Ä–º–∏—Ä—É—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ —è–¥—Ä–æ –ø—Ä–æ–µ–∫—Ç–∞.

---

